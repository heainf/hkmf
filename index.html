<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>香港屋苑管理費資料收集</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        label {
            display: block;
            margin: 10px 0 5px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
        }
        button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>香港屋苑管理費資料收集</h1>
        <p>請填寫以下資料，幫助我們建立管理費資料庫。感謝你的參與！</p>
        <form id="estateForm" action="https://script.google.com/macros/s/AKfycbwvcU6zfG8AdPYE4hiId9tbf5-G2vXh3Yk2pAokMb0vglT_iB7nwYcoPXTvXZV6L0KQag/exec" method="POST" target="hiddenFrame" onsubmit="submitForm()">
            <label for="estateName">屋苑名稱 *</label>
            <select id="estateName" name="estateName" required onchange="toggleCustomEstate(this)">
                <option value="得寶花園" selected>得寶花園</option>
                <option value="淘大花園">淘大花園</option>
                <option value="德福花園">德福花園</option>
                <option value="custom">自己輸入</option>
            </select>
            <input type="text" id="customEstate" name="customEstate" style="display:none;" placeholder="請輸入屋苑名稱">

            <label for="buildingNumber">座數</label>
            <select id="buildingNumber" name="buildingNumber" onchange="toggleCustomBuilding(this)">
                <option value="" selected>請選擇</option>
                <!-- 1-20 -->
                <option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option>
                <option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option>
                <option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option>
                <option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option>
                <!-- A-Z -->
                <option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option>
                <option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option>
                <option value="K">K</option><option value="L">L</option><option value="M">M</option><option value="N">N</option><option value="O">O</option>
                <option value="P">P</option><option value="Q">Q</option><option value="R">R</option><option value="S">S</option><option value="T">T</option>
                <option value="U">U</option><option value="V">V</option><option value="W">W</option><option value="X">X</option><option value="Y">Y</option>
                <option value="Z">Z</option>
                <option value="custom">自己輸入</option>
            </select>
            <input type="text" id="customBuilding" name="customBuilding" style="display:none;" placeholder="請輸入座數">

            <label for="unitNumber">單位</label>
            <select id="unitNumber" name="unitNumber" onchange="toggleCustomUnit(this)">
                <option value="" selected>請選擇</option>
                <!-- 1-20 -->
                <option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option>
                <option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option>
                <option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option>
                <option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option>
                <!-- A-Z -->
                <option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option>
                <option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option>
                <option value="K">K</option><option value="L">L</option><option value="M">M</option><option value="N">N</option><option value="O">O</option>
                <option value="P">P</option><option value="Q">Q</option><option value="R">R</option><option value="S">S</option><option value="T">T</option>
                <option value="U">U</option><option value="V">V</option><option value="W">W</option><option value="X">X</option><option value="Y">Y</option>
                <option value="Z">Z</option>
                <option value="custom">自己輸入</option>
            </select>
            <input type="text" id="customUnit" name="customUnit" style="display:none;" placeholder="請輸入單位">

            <label for="area">實用面積 (平方呎)</label>
            <input type="text" id="area" name="area" placeholder="例如：300">

            <label for="managementFee">管理費</label>
            <input type="text" id="managementFee" name="managementFee" placeholder="例如：900">

            <label for="year">年份 (四位)</label>
            <input type="text" id="year" name="year" maxlength="4" placeholder="例如：2025">

            <label for="date">日期 (如有)</label>
            <input type="text" id="date" name="date" placeholder="例如：2025-03-27">

            <label for="comments">備註</label>
            <textarea id="comments" name="comments" rows="4" placeholder="其他相關信息"></textarea>

            <button type="submit">提交資料</button>
        </form>
        <iframe name="hiddenFrame" style="display:none;"></iframe>
    </div>

    <script>
        function toggleCustomEstate(select) {
            const customInput = document.getElementById('customEstate');
            if (select.value === 'custom') {
                customInput.style.display = 'block';
                customInput.required = true;
            } else {
                customInput.style.display = 'none';
                customInput.required = false;
                customInput.value = '';
            }
        }

        function toggleCustomBuilding(select) {
            const customInput = document.getElementById('customBuilding');
            if (select.value === 'custom') {
                customInput.style.display = 'block';
            } else {
                customInput.style.display = 'none';
                customInput.value = '';
            }
        }

        function toggleCustomUnit(select) {
            const customInput = document.getElementById('customUnit');
            if (select.value === 'custom') {
                customInput.style.display = 'block';
            } else {
                customInput.style.display = 'none';
                customInput.value = '';
            }
        }

        function submitForm() {
            const estateSelect = document.getElementById('estateName');
            const customEstate = document.getElementById('customEstate');
            if (estateSelect.value === 'custom' && customEstate.value) {
                estateSelect.value = customEstate.value; // 將自訂值傳回主欄位
            }

            const buildingSelect = document.getElementById('buildingNumber');
            const customBuilding = document.getElementById('customBuilding');
            if (buildingSelect.value === 'custom' && customBuilding.value) {
                buildingSelect.value = customBuilding.value;
            }

            const unitSelect = document.getElementById('unitNumber');
            const customUnit = document.getElementById('customUnit');
            if (unitSelect.value === 'custom' && customUnit.value) {
                unitSelect.value = customUnit.value;
            }

            setTimeout(() => {
                alert('感謝你的提交！資料已成功儲存到Google Sheets。');
                document.getElementById('estateForm').reset();
            }, 1000);
        }
    </script>
</body>
</html>
